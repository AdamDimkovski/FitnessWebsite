<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Litness</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="images/favicon.png">
  
  <link rel="stylesheet" href="style-calculator.css">

  <!-- Firebase App (compat version) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>

  <!-- Firebase Authentication (compat version) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <!-- Firebase Firestore (compat version) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar">
  <ul class="nav-list">

    <li class="nav-item">
      <a href="index.html">Home</a>
    </li>

    <li class="nav-item">
      <a href="calculator.html">Maintenance Calculator</a>
    </li>

    <li class="nav-item">
      <a href="food.html">Diet Tracker</a>
    </li>

    <li class="nav-item">
      <a href="exercise.html">Workout Tracker</a>
    </li>

    <!-- Auth‑controlled items -->
    <li class="nav-item" id="signupLink">
      <a href="sign-up.html">Sign Up</a>
    </li>

    <li class="nav-item" id="loginLink">
      <a href="log-in.html">Log In</a>
    </li>

    <li class="nav-item" id="profileLink">
      <a href="profile.html">Profile</a>
    </li>

    <li class="nav-item" id="logoutLink">
      <a href="#">Log Out</a>
    </li>

  </ul>
</nav>

<main class="page">

  <!-- Page Header -->
  <header class="page-header">
    <h1>Calorie Calculator</h1>
    <p class="page-subtitle">
      Estimate your daily maintenance calories and adjust for weight loss or gain
      based on your lifestyle.
    </p>
  </header>

  <!-- Calculator -->
  <section class="calculator-section">
    <div class="calculator-card">

      <!-- Personal Details -->
      <fieldset class="form-section">
        <legend class="section-header">Personal Details</legend>

        <div class="input-grid">

          <!-- Age -->
          <div class="input-group">
            <label for="ageInput" class="label-with-tooltip">
              Age
              <span class="tooltip" aria-label="Help">
                ?
                <span class="tooltiptext">
                  Your age helps estimate your metabolic rate.
                </span>
              </span>
            </label>

            <input
              type="number"
              id="ageInput"
              placeholder="Years"
              min="0"
            >
          </div>

          <!-- Gender -->
          <div class="input-group">
            <label class="label-with-tooltip">
              Gender
              <span class="tooltip" aria-label="Help">
                ?
                <span class="tooltiptext">
                  Gender influences how your body burns calories.
                </span>
              </span>
            </label>

            <div class="gender-toggle" role="group" aria-label="Gender selection">
              <button
                type="button"
                class="gender-btn active"
                data-gender="Male"
                aria-pressed="true"
              >
                Male
              </button>

              <button
                type="button"
                class="gender-btn"
                data-gender="Female"
                aria-pressed="false"
              >
                Female
              </button>
            </div>
          </div>

            <!-- Height -->
            <div class="input-group">
              <label class="label-with-tooltip" for="heightInput">
                Height
                <span class="tooltip">?
                  <span class="tooltiptext">
                    Enter your height using your selected unit.
                  </span>
                </span>
              </label>

              <input
                type="number"
                id="heightInput"
                placeholder="Height"
                min="0"
              >
            </div>

            <!-- Weight -->
            <div class="input-group">
              <label class="label-with-tooltip" for="weightInput">
                Weight
                <span class="tooltip">?
                  <span class="tooltiptext">
                    Enter your current body weight.
                  </span>
                </span>
              </label>

              <input
                type="number"
                id="weightInput"
                placeholder="Weight"
                min="0"
              >
            </div>


            <!-- Activity Level -->
            <div class="input-group">
              <label class="label-with-tooltip" for="myDropdown">
                Activity Level
                <span class="tooltip">?
                  <span class="tooltiptext">
                    Choose the option that best matches your weekly activity.
                  </span>
                </span>
              </label>

              <div class="custom-select">
                <select id="myDropdown">
                  <option value="">Select activity level</option>
                  <option value="option1">Sedentary</option>
                  <option value="option2">Lightly Active (1–3 days/week)</option>
                  <option value="option3">Moderately Active (3–5 days/week)</option>
                  <option value="option4">Very Active (6–7 days/week)</option>
                  <option value="option5">Super Active</option>
                </select>

                <div class="dropdown-menu"></div>
              </div>
            </div>

            <!-- Goal -->
            <div class="input-group">
              <label class="label-with-tooltip" for="goalSelect">
                Goal
                <span class="tooltip">?
                  <span class="tooltiptext">
                    Choose whether you want to maintain, lose, or gain weight.
                  </span>
                </span>
              </label>

              <div class="custom-select">
                <select id="goalSelect">
                  <option value="">Select goal</option>
                  <option value="maintain">Maintain weight</option>
                  <option value="lose">Lose weight</option>
                  <option value="gain">Gain weight</option>
                </select>

                <div class="dropdown-menu"></div>
              </div>
            </div>

            </div>
          </fieldset>

      <!-- Calculate -->
      <div class="action-row">
        <button class="calculate-button" onclick="calculateMain()">
          Calculate Calories
        </button>
      </div>

      <!-- Extra Settings -->
      <section class="extra-settings">

        <div class="settings-header">
          <span class="settings-title">Extra Settings</span>
          <span class="tooltip">?
            <span class="tooltiptext">
              Adjust your preferred height and weight units.
            </span>
          </span>
        </div>

        <button type="button" class="collapsible-btn">
          Unit Preferences
        </button>

        <div class="collapsible-content">
          <fieldset class="settings-fieldset">
            <legend>Measurement Units</legend>

            <!-- Weight Unit -->
            <div class="settings-row">
              <label>Weight Unit</label>
              <div class="toggle-group" id="weight-toggle">
                <button type="button" class="toggle-btn active" data-unit="kg">kg</button>
                <button type="button" class="toggle-btn" data-unit="lbs">lbs</button>
              </div>
            </div>

            <!-- Height Unit -->
            <div class="settings-row">
              <label>Height Unit</label>
              <div class="toggle-group" id="height-toggle">
                <button type="button" class="toggle-btn active" data-unit="cm">cm</button>
                <button type="button" class="toggle-btn" data-unit="inches">inches</button>
              </div>
            </div>

          </fieldset>
        </div>

      </section>

      <!-- Results -->
      <div id="resultBox" class="result-box">
        <p id="resultOutput"></p>
      </div>

    </div>
  </section>

</main>


<script>
document.addEventListener("DOMContentLoaded", () => {
  // Collapsible
  const button = document.querySelector(".collapsible-btn");
  const content = document.querySelector(".collapsible-content");

  button.addEventListener("click", () => {
    content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + "px";
  });

  // Unit toggles
  window.selectedWeightUnit = "kg";
  window.selectedHeightUnit = "cm";

  document.querySelectorAll("#weight-toggle .toggle-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      selectedWeightUnit = btn.dataset.unit;
      document.querySelectorAll("#weight-toggle .toggle-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    });
  });

  document.querySelectorAll("#height-toggle .toggle-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      selectedHeightUnit = btn.dataset.unit;
      document.querySelectorAll("#height-toggle .toggle-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    });
  });

  // Gender toggle buttons
  window.selectedGender = "Male"; // default

  document.querySelectorAll(".gender-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      selectedGender = btn.dataset.gender;
      document.querySelectorAll(".gender-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    });
  });
});

// Main calculation
function calculateMain() {
  const age = parseInt(document.getElementById("ageInput").value);
  let weight = parseFloat(document.getElementById("weightInput").value);
  let height = parseFloat(document.getElementById("heightInput").value);

  const weightUnit = selectedWeightUnit;
  const heightUnit = selectedHeightUnit;
  const gender = selectedGender;
  const activityLevel = document.getElementById("myDropdown").value;
  const goal = document.getElementById("goalSelect").value;

  // Validation
  if (!age) return alert("Please enter your age!");
  if (!gender) return alert("Please select your gender!");
  if (!height) return alert("Please enter your height!");
  if (!weight) return alert("Please enter your weight!");
  if (!activityLevel) return alert("Please select your activity level!");
  if (!goal) return alert("Please select your goal!");

  // Convert units
  if (weightUnit === "lbs") weight *= 0.453592;
  if (heightUnit === "inches") height *= 2.54;

  // BMR calculation
  let bmr;
  if (gender === "Male") {
    bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
  } else {
    bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
  }

  // Activity multiplier
  let maintenance;
  switch (activityLevel) {
    case "option1": maintenance = bmr * 1.2; break;
    case "option2": maintenance = bmr * 1.375; break;
    case "option3": maintenance = bmr * 1.55; break;
    case "option4": maintenance = bmr * 1.725; break;
    case "option5": maintenance = bmr * 1.9; break;
  }

  // Goal adjustment
  let targetCalories =
    goal === "maintain" ? maintenance :
    goal === "lose" ? maintenance - 250 :
    maintenance + 250;

  // Macronutrients
  const proteinGrams = ((targetCalories * 0.30) / 4).toFixed(0);
  const carbGrams = ((targetCalories * 0.40) / 4).toFixed(0);
  const fatGrams = ((targetCalories * 0.30) / 9).toFixed(0);

  // Display results
  document.getElementById("resultBox").style.display = "block";
  document.getElementById("resultOutput").innerHTML = `
    <h2>Results</h2>
    <p><strong>BMR:</strong> ${bmr.toFixed(2)} kcal/day</p>
    <p><strong>Maintenance Calories:</strong> ${maintenance.toFixed(2)} kcal/day</p>
    <p><strong>Target Calories:</strong> ${targetCalories.toFixed(2)} kcal/day</p>
    <h3>Macronutrient Breakdown</h3>
    <p>Protein: ${proteinGrams} g/day</p>
    <p>Carbs: ${carbGrams} g/day</p>
    <p>Fat: ${fatGrams} g/day</p>
  `;
}


document.querySelectorAll(".custom-select").forEach(selectWrapper => {
  const select = selectWrapper.querySelector("select");
  const menu = selectWrapper.querySelector(".dropdown-menu");

  // Build menu items
  menu.innerHTML = "";
  [...select.options].forEach(opt => {
    const item = document.createElement("div");
    item.className = "dropdown-item";
    item.textContent = opt.textContent;

    item.addEventListener("click", () => {
      select.value = opt.value;
      selectWrapper.classList.remove("open");
    });

    menu.appendChild(item);
  });

  // Prevent native dropdown from opening
  select.addEventListener("mousedown", e => {
    e.preventDefault();
    selectWrapper.classList.toggle("open");
  });
});

// Close when clicking outside
document.addEventListener("click", e => {
  document.querySelectorAll(".custom-select").forEach(wrapper => {
    if (!wrapper.contains(e.target)) wrapper.classList.remove("open");
  });
});

</script>

<!-- Scripts -->
  <script src="firebase.js"></script>
  <script src="script.js"></script>

<script>
auth.onAuthStateChanged(user => {
updateUIForAuthState(user);
});
</script>


<!-- Footer -->
<footer class="page-footer">
  <span class="footer-text">Litness</span>
</footer>

</body>

</html>